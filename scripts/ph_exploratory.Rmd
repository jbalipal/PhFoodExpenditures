---
title: "ph_exploratory"
author: "Julius Alipala"
date: "March 6, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r imports}
library(vegan)
```

```{r load}
dat = read.csv('../data/ph_fies.csv')
region_codes = read.csv('../data/region_codes.csv')

```


```{r subset}
# features to inpect
features = c("Total.Household.Income", "Region", 
             "Education.Expenditure", "Total.Number.of.Family.members", 
             "Total.Food.Expenditure", "Bread.and.Cereals.Expenditure",
             "Total.Rice.Expenditure", "Meat.Expenditure",
             "Total.Fish.and..marine.products.Expenditure", "Fruit.Expenditure",
             "Vegetables.Expenditure")

# data with only features to inspect
dat_sub = dat[,features]
```

```{r merge}
# add island groups to samples for coarser level of granularity
dat_merged = merge(dat_sub, region_codes, all.x=TRUE)
```

Examining income and food expenditures for each island (Luzon, Visayas, Mindanao).
```{r islands}
boxplot(Total.Household.Income ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="household income", las=2)

boxplot(Total.Food.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="food expenditure", las=2)

boxplot(Total.Rice.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="rice expenditure", las=2)

boxplot(Meat.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="meat expenditure", las=2)

boxplot(Total.Fish.and..marine.products.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="seafood expenditure", las=2)

boxplot(Fruit.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="fruit expenditure", las=2)

boxplot(Vegetables.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="vegetables expenditure", las=2)

boxplot(Bread.and.Cereals.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="bread/cereals expenditure", las=2)
```

Examining effect of number of family members on food expenditure.
```{r family}
plot(Total.Food.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="food expenditure", las=2)

plot(Meat.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="meat expenditure", las=2)

plot(Total.Fish.and..marine.products.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="seafood expenditure", las=2)

plot(Total.Rice.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="rice expenditure", las=2)

plot(Bread.and.Cereals.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="bread and cereal expenditure", las=2)

plot(Fruit.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="fruit expenditure", las=2)

plot(Vegetables.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="vegetables expenditure", las=2)

```

Examining effect of education expenditure on food expenditure.
```{r education}
plot(Total.Food.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="food expenditure", las=2)

plot(Meat.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="meat expenditure", las=2)

plot(Total.Fish.and..marine.products.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="seafood expenditure", las=2)

plot(Total.Rice.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="rice expenditure", las=2)

plot(Bread.and.Cereals.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="bread and cereal expenditure", las=2)

plot(Fruit.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="fruit expenditure", las=2)

plot(Vegetables.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="vegetables expenditure", las=2)

```
Rice expenditure is quite steady throughout the regions. There is more variation in meat expenditure than I expected. I expected more variation in seafood.


```{r models}
meat_mod = lm(Meat.Expenditure ~
               log10(Total.Household.Income) + Island, data=dat_merged)
summary(meat_mod)

rice_mod = lm(Total.Rice.Expenditure ~
                Total.Number.of.Family.members, data=dat_merged)
summary(rice_mod)

bread_cereals_mod = lm(Bread.and.Cereals.Expenditure ~
                Total.Number.of.Family.members, data=dat_merged)
summary(bread_cereals_mod)


#termplot(meat_mod, partial.resid = T, se=T)
#termplot(rice_mod, partial.resid = T, se=T)
#termplot(bread_cereals_mod, partial.resid = T, se=T)
```

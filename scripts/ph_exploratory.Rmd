---
title: "ph_exploratory"
author: "Julius Alipala"
date: "March 6, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r imports}
library(vegan)
```

```{r load}
dat = read.csv('../data/ph_fies.csv')
region_codes = read.csv('../data/region_codes.csv')

```


```{r subset}
# features to inspect
features = c("Total.Household.Income", "Region", 
             "Education.Expenditure", "Total.Number.of.Family.members", 
             "Total.Food.Expenditure", "Bread.and.Cereals.Expenditure",
             "Total.Rice.Expenditure", "Meat.Expenditure",
             "Total.Fish.and..marine.products.Expenditure", "Fruit.Expenditure",
             "Vegetables.Expenditure")

# data with only features to inspect
dat_sub = dat[,features]
```

```{r merge}
# add island groups to samples for coarser level of granularity
dat_merged = merge(dat_sub, region_codes, all.x=TRUE)
```

Initial assumptions:
1) Region will not have a significant effect on rice expenditure.
2) Income will not have a significant effect on rice expenditure.
3) People living in Visayas will spend more on seafood.
4) People will spend more on seafood than on meat.
5) Higher income households will spend more on meat.
6) Mindanao will spend less on meat.

Examining income and food expenditures for each island (Luzon, Visayas, Mindanao).
```{r islands}
par(mfrow=c(2,4), mgp = c(3,1,0))

boxplot(Total.Household.Income ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="household income (pesos)",
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Total.Food.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="food expenditure (pesos)",
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Total.Rice.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="rice expenditure (pesos)", 
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Meat.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="meat expenditure (pesos)", 
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Total.Fish.and..marine.products.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="seafood expenditure (pesos)", 
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Fruit.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="fruit expenditure (pesos)",
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Vegetables.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="vegetables expenditure (pesos)",
        names=c("Luz", "Min", "Vis"), las=1)

boxplot(Bread.and.Cereals.Expenditure ~ Island, data=dat_merged,
        outline=FALSE, xlab="island", ylab="bread/cereals expenditure (pesos)",
        names=c("Luz", "Min", "Vis"), las=1)
```
Luzon spends more on meat than the other islands, with Mindanao spending the least. Luzon also spends slightly more on fruits and vegetables compared to the other islands. Luzon also has the highest total household income. This seems to support assumptions 1 and 6.


Do people spend more on seafood than on meat?
```{r means}
colMeans(dat_merged[c("Meat.Expenditure", "Total.Fish.and..marine.products.Expenditure")])
```
Assumption 4 does not hold. Meat expenditure is higher on average although it's not by a significant amount.


Does Visayas spend more on seafood compared to other islands?
```{r visayas}
aggregate(dat_merged["Total.Fish.and..marine.products.Expenditure"], list(dat_merged$Island), mean)

```
Visayas does spend more on seafood compared to the other islands. This supports assumption 3, although the difference in spending between the islands is only differs by a few hundred pesos.


Examining effect of number of family members on food expenditure.
```{r family}
plot(Total.Food.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="food expenditure", las=2)

plot(Meat.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="meat expenditure", las=2)

plot(Total.Fish.and..marine.products.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="seafood expenditure", las=2)

plot(Total.Rice.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="rice expenditure", las=2)

plot(Bread.and.Cereals.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="bread and cereal expenditure", las=2)

plot(Fruit.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="fruit expenditure", las=2)

plot(Vegetables.Expenditure ~ Total.Number.of.Family.members, data=dat_merged,
        xlab="family size", ylab="vegetables expenditure", las=2)

```

Examining effect of education expenditure on food expenditure.
```{r education}
plot(Total.Food.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="food expenditure", las=2)

plot(Meat.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="meat expenditure", las=2)

plot(Total.Fish.and..marine.products.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="seafood expenditure", las=2)

plot(Total.Rice.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="rice expenditure", las=2)

plot(Bread.and.Cereals.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="bread and cereal expenditure", las=2)

plot(Fruit.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="fruit expenditure", las=2)

plot(Vegetables.Expenditure ~ Education.Expenditure, data=dat_merged,
        xlab="education", ylab="vegetables expenditure", las=2)

```
Rice expenditure is quite steady throughout the regions. There is more variation in meat expenditure than I expected. I expected more variation in seafood.


```{r models}
meat_mod = lm(Meat.Expenditure ~
               log10(Total.Household.Income) + Island, data=dat_merged)
summary(meat_mod)

rice_mod = lm(Total.Rice.Expenditure ~
                Total.Number.of.Family.members, data=dat_merged)
summary(rice_mod)

bread_cereals_mod = lm(Bread.and.Cereals.Expenditure ~
                Total.Number.of.Family.members, data=dat_merged)
summary(bread_cereals_mod)


#termplot(meat_mod, partial.resid = T, se=T)
#termplot(rice_mod, partial.resid = T, se=T)
#termplot(bread_cereals_mod, partial.resid = T, se=T)
```
